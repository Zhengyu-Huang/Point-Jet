function  y_up = step_ab3t(y, F, tlev, damping, dt)%STEP_AB3T   Third-order Adams-Bashforth-trapezoidal time step.%    STEP_AB3T(y, F, tlev, damping, dt) performs a third order%    Adams-Bashforth time step to advance the solution y of the%    ordinary differential equation%         %                    dy/dt = F - damping .* y%%    by one time step. The damping coefficient must be either a%    constant scalar or a constant matrix of the same size as y. The%    right hand side F must be given at three time levels: F{tlev(1)}%    at the current time level n, at which the solution y is given on%    input; F{tlev(2)} at the time level n-1 one step back; and%    F{tlev(3)} at the time level n-2 two steps back. That is, the%    right hand side is assumed to be given as a cell 3-vector F of%    right-hand sides for different time levels, with the index vector%    tlev indicating which element in the cell corresponds to which%    time level.%   %    The right-hand side F is differenced by a third-order%    Adams-Bashcroft difference; the damping term is differenced by a%    semi-implicit trapezoidal difference.%    Reference: D. Durran, Numerical Methods for Wave Equations in%    Geophysical Fluid Dynamics, Springer (1999), p. 143.    if nargin ~= 5    error('Wrong number of arguments. See STEP_AB3T.')  end    y_up = ( y + ...	   dt/12 * (23*F{tlev(1)} - 16*F{tlev(2)} + 5*F{tlev(3)} ) ...	   - 0.5 * dt * damping .* y ) ...	 ./ ( 1 + 0.5 * dt * damping);