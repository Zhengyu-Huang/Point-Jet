function gfield = gfft2(wfield, nx, ny)%GFFT2   Wave-to-grid Fourier transform. %    GFIELD = GFFT2(WFIELD, nx, ny) transforms the field WFIELD in%    wavenumber space to the field GFIELD on a grid of size [nx, ny].%%    GFFT2 is the inverse of WFFT2.    [nkx, nky] = size(wfield);    % y-indices of nonzero entries in full wavenumber field of size [nx,ny]  kys        = [1:ceil(nky/2), ny-floor(nky/2)+1:ny];  ikys       = [1, ny:-1:ny-floor(nky/2)+1, ceil(nky/2): -1 :2];  % assemble full wavenumber field (including zero pads)  wfieldl                       = complex(zeros(nx, ny));  wfieldl(1:nkx, kys)           = wfield;  wfieldl(nx:-1:nx-nkx+2, ikys) = conj(wfield(2:nkx, :));     % transform from wavenumber space to grid space  gfield     = real(ifft2(wfieldl));